<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=arrow_back_ios" />
  <title>Harpa Cristã</title>
  <link rel="stylesheet" href="./harpa.css">
  <link rel="shortcut icon" href="./Story Book.svg" type="svg">
</head>
<body>
    <div class="title-app">
        <svg xmlns="http://www.w3.org/2000/svg" class="menu" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M120-240v-80h240v80H120Zm0-200v-80h480v80H120Zm0-200v-80h720v80H120Z"/></svg>
        <h1>Harpa Cristã</h1>
        <svg xmlns="http://www.w3.org/2000/svg" class="search-harpa" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg>
    </div>

    <!--search-->
    <input type="text" id="search-input-harpa" placeholder="Digite o nome ou número do hino..." oninput="filtrarHinos()">
    <!--/search-->

  <!-- Tela de Lista de Hinos -->
  <div id="tela-hinos" class="tela ativa"></div>

  <!-- Tela de Exibição de Letra -->
  <div id="tela-letra" class="tela">
    <div class="voltar" onclick="voltarParaHinos()">
        <span class="material-symbols-outlined">
            arrow_back_ios
        </span> Voltar
    </div>
    <h2 id="titulo-hino"></h2>
    <div id="coro"></div>
    <div id="versiculos"></div>
  </div>

  <script>
    let harpa = [];

fetch('harpa.json')
  .then(response => response.json())
  .then(data => {
    harpa = data;
    carregarHinos();
  })
  .catch(error => console.error("Erro ao carregar o JSON:", error));

function mostrarTela(id) {
  document.querySelectorAll('.tela').forEach(tela => tela.classList.remove('ativa'));
  document.getElementById(id).classList.add('ativa');
}

function carregarHinos() {
  const container = document.getElementById('tela-hinos');
  container.innerHTML = '';

  if (!harpa || Object.keys(harpa).length === 0) {
    container.innerHTML = "<p>Erro ao carregar os hinos. Verifique o JSON.</p>";
    return;
  }

  Object.keys(harpa).forEach(hinoNum => {
    const hino = harpa[hinoNum];

    const div = document.createElement('div');
    div.className = 'hino';

    const idDiv = document.createElement('div');
    idDiv.className = 'hino-id';
    idDiv.textContent = hinoNum;

    const infoDiv = document.createElement('div');
    infoDiv.className = 'hino-info';

    // Remove o número do título na tela inicial
    const nomeHino = hino.hino.replace(/^\d+\s*-\s*/, ""); 
    infoDiv.innerHTML = `<h2>${nomeHino}</h2>`;

    div.appendChild(idDiv);
    div.appendChild(infoDiv);
    div.onclick = () => carregarLetra(hinoNum);
    container.appendChild(div);
  });

  mostrarTela('tela-hinos');
}

function carregarLetra(hinoNum) {
  const hino = harpa[hinoNum];

  if (!hino) {
    console.error("Erro: Hino não encontrado.");
    return;
  }

  const titulo = document.getElementById('titulo-hino');
  const versiculosDiv = document.getElementById('versiculos');

  // Mantém o número no título da tela interna
  titulo.textContent = hino.hino; 
  versiculosDiv.innerHTML = '<h3></h3>';

  Object.keys(hino.verses).forEach(num => {
    const p = document.createElement('p');
    p.innerHTML = `${num}. ${hino.verses[num].replace(/<br>/g, "")}`;
    versiculosDiv.appendChild(p);

    // Adiciona o coro abaixo de cada verso
    const coroP = document.createElement('p');
    coroP.className = 'coro'; 
    coroP.innerHTML = `<em><strong></strong> ${hino.coro.replace(/<br>/g, "")}</em>`;
    versiculosDiv.appendChild(coroP);
  });

  mostrarTela('tela-letra');
}

function voltarParaHinos() {
  mostrarTela('tela-hinos');
}

  </script>
  <script src="./searchharpa.js"></script>
</body>
</html>
